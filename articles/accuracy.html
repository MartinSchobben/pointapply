<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pointapply">
<title>SIMS analytical artefacts • pointapply</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SIMS analytical artefacts">
<meta property="og:description" content="pointapply">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pointapply</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9002</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/accuracy.html">SIMS analytical artefacts</a>
    <a class="dropdown-item" href="../articles/data.html">Reading matlab files</a>
    <a class="dropdown-item" href="../articles/performance.html">Visualise test performance</a>
    <a class="dropdown-item" href="../articles/raster.html">Raster images</a>
    <a class="dropdown-item" href="../articles/regression.html">Validation of regression assumptions</a>
    <a class="dropdown-item" href="../articles/simulation.html">Sensitivity by simulation</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="accuracy_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>SIMS analytical artefacts</h1>
            
      
      
      <div class="d-none name"><code>accuracy.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette deals with the evaluation of the impact of systematic and random biases on high-precision isotope data generated with the nanoSIMS 50L, and as discussed in the Supplementary Information of the paper (Supplementary Section 2.1 <em>Precision of isotope analysis</em> and Supplementary Section 2.3 <em>Quasi simultaneous Arrival</em>). The here discussed analytical artefacts all have been argued to compromise SIMS isotope analyses and do not relate to the isotope homogeneity of the analyte (i.e., the target of this study).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://martinschobben.github.io/point/" class="external-link">point</a></span><span class="op">)</span> <span class="co"># regression diagnostics</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://martinschobben.github.io/pointapply/">pointapply</a></span><span class="op">)</span> <span class="co"># load package</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="download-data">Download data<a class="anchor" aria-label="anchor" href="#download-data"></a>
</h2>
<p>The assessment of these analytical artefacts is largely based on the <em>point</em> R package. Information on how to generate processed data from raw data can be found in the vignette <em>Reading matlab files</em> (<code><a href="../articles/data.html">vignette("data")</a></code>). Alternatively, processed data can be downloaded from <a href="https://doi.org/10.5281/zenodo.4564170" class="external-link">Zenodo</a> with the function <code><a href="../reference/download_point.html">download_point()</a></code>. Simulated data (<em>Sensitivity by simulation</em> (<code><a href="../articles/simulation.html">vignette("simulation")</a></code>) is used to gauge the effectiveness of precision metrics (such as, the error of the mean) of an SIMS isotope analysis in detecting isotopically anomalies entrained in the analyte (intra-analysis isotope variability).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># use download_point() to obtain processed data (only has to be done once)</span>
<span class="fu"><a href="../reference/download_point.html">download_point</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"processed"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<p>For this example processed “real” data is loaded with a grid-cell size of 64 pixels by 64 pixels (100<span class="math inline">\(\,\mu\)</span>m^2). Simulated data processed with Cook’s D regression diagnostics is used to compare the here developed intra-analysis isotope test statistic with precision metrics.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load "real" data</span>
<span class="fu"><a href="../reference/download_point.html">load_point</a></span><span class="op">(</span><span class="st">"map_sum_grid"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MEX"</span>, <span class="st">"MON"</span><span class="op">)</span>, grid_cell <span class="op">=</span> <span class="fl">64</span><span class="op">)</span>
<span class="co"># load simulated data (intra-analysis isotope variability)</span>
<span class="fu"><a href="../reference/download_point.html">load_point</a></span><span class="op">(</span><span class="st">"simu"</span>, <span class="st">"sens_IC_intra"</span><span class="op">)</span>
<span class="co"># load test statistics (intra-analysis isotope variability)</span>
<span class="fu"><a href="../reference/download_point.html">load_point</a></span><span class="op">(</span><span class="st">"simu"</span>, <span class="st">"CooksD_IC_intra"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="systematic-biases">Systematic biases<a class="anchor" aria-label="anchor" href="#systematic-biases"></a>
</h2>
<div class="section level3">
<h3 id="quasi-simultaneous-arrival-qsa">Quasi simultaneous Arrival (QSA)<a class="anchor" aria-label="anchor" href="#quasi-simultaneous-arrival-qsa"></a>
</h3>
<p>The combination of measuring under high ionisation efficiencies and the usage of electron multipliers (EM) for ion detection can lead to an artefact understood as the more-or-less (quasi) simultaneous arrival (QSA) of an incident ion at the detection device. Differentiation of the two secondary ions is thus not possible, and the ions are therefore counted as <span class="math inline">\(1\)</span> detection event by the machine. In the case of isotope systems this could theoretically lead to under-sampling of the common isotope <span class="citation">(Slodzian et al. 2004)</span>. An exact correction of under-sampling induced by QSA can be a cumbersome undertaking, as such the R package <code>point</code> <span class="citation">(Schobben 2022)</span> has a diagnostic tool that helps evaluate whether the ion count data is likely to have been compromised by this analytical artefact. The function <code><a href="https://martinschobben.github.io/point/reference/QSA_test.html" class="external-link">QSA_test()</a></code> fits a least-square linear model to the common isotope count rates (e.g. <sup>12</sup>C) as a predictor, and the targeted isotope ratio (e.g. <sup>13</sup>C/<sup>12</sup>C) as the independent variable. If under-sampling would be present in the ion count data, then this would cause a significant positive linear trend of higher isotope ratios with higher count rates of the common isotope.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>

<span class="co"># combine data</span>
<span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">map_sum_grid_64_MEX</span>, <span class="va">map_sum_grid_64_MON</span><span class="op">)</span>
<span class="co"># QSA test</span>
<span class="va">test_QSA_64_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://martinschobben.github.io/point/reference/QSA_test.html" class="external-link">QSA_test</a></span><span class="op">(</span><span class="va">tb</span>, <span class="st">"13C"</span>, <span class="st">"12C"</span>, <span class="va">file.nm</span>, <span class="va">sample.nm</span>, <span class="va">grid.nm</span>, 
                            .nest <span class="op">=</span> <span class="va">grid.nm</span><span class="op">)</span>
<span class="co"># make mlm model line</span>
<span class="va">test_QSA_64_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
  <span class="va">test_QSA_64_all</span>, 
  hat_R <span class="op">=</span> <span class="va">alpha_grid.nm</span> <span class="op">+</span> <span class="va">beta_grid.nm</span> <span class="op">*</span> <span class="va">Xt.pr.12C</span>
<span class="op">)</span></code></pre></div>
<p>The function <code>gg_dens</code> provided in this package is used to visualise the high density data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># labels for ion count rates</span>
<span class="va">xlab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span>
  <span class="va">a</span> <span class="op">~</span> <span class="st">"(count sec"</span><span class="op">^</span><span class="st">"-"</span><span class="op">*</span><span class="st">")"</span>, 
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu">point</span><span class="fu">::</span><span class="fu"><a href="https://martinschobben.github.io/point/reference/ion_labeller.html" class="external-link">ion_labeller</a></span><span class="op">(</span><span class="st">"12C"</span>, <span class="st">"expr"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="va">ylab</span> <span class="op">&lt;-</span> <span class="fu">point</span><span class="fu">::</span><span class="fu"><a href="https://martinschobben.github.io/point/reference/ion_labeller.html" class="external-link">R_labeller</a></span><span class="op">(</span><span class="st">"13C"</span>, <span class="st">"12C"</span>, <span class="st">"expr"</span><span class="op">)</span>

<span class="co"># plot</span>
<span class="va">QSA_dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gg_dens.html">gg_dens</a></span><span class="op">(</span>
  IC <span class="op">=</span> <span class="va">test_QSA_64_all</span>, 
  x <span class="op">=</span> <span class="va">Xt.pr.12C</span>,
  y <span class="op">=</span> <span class="va">R_Xt.pr</span>, 
  xlab <span class="op">=</span> <span class="va">xlab</span>, 
  ylab <span class="op">=</span> <span class="va">ylab</span>, 
  ttl <span class="op">=</span> <span class="st">"QSA test"</span>,
  gr <span class="op">=</span> <span class="va">sample.nm</span>,
  unit <span class="op">=</span> <span class="st">"dim"</span>,
  facet_sc <span class="op">=</span> <span class="st">"free"</span>,
  labels <span class="op">=</span> <span class="st">"scientific"</span>
<span class="op">)</span>

<span class="co"># add lm line</span>
<span class="va">QSA_dens</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">hat_R</span><span class="op">)</span><span class="op">)</span> 

<span class="co"># save data</span>
<span class="fu"><a href="../reference/download_point.html">write_point</a></span><span class="op">(</span><span class="va">test_QSA_64_all</span><span class="op">)</span>
 
<span class="co"># save plot  </span>
<span class="fu"><a href="../reference/download_point.html">save_point</a></span><span class="op">(</span><span class="st">"point_QSA"</span>, <span class="fu">last_plot</span><span class="op">(</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">15</span>, height <span class="op">=</span> <span class="fl">10</span>, unit <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="figures/point_QSA.png" alt="QSA test." width="80%"><p class="caption">
QSA test.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="random-bias">Random bias<a class="anchor" aria-label="anchor" href="#random-bias"></a>
</h2>
<p>The random nature of secondary ions emitted from an analytical substrate (e.g. rock sample) during sputtering can be described by Poisson statistics, which can be used to predict the precision of pulsed ion counts (e.g. measurements with a <em>Cameca NanoSIMS 50L</em>) under ideal circumstances. More specifically, the variation can be deduced from the total counts of secondary ions. Usefully, we can compare these predictive values with the descriptive statistics; essentially estimates of the true population location (e.g. mean) and spread (variance).</p>
<p>First we will calculate some standard predictive and descriptive statistics for the internal precision of SIMS single iona, with the <code>point</code> function <code><a href="https://martinschobben.github.io/point/reference/stat_X.html" class="external-link">stat_X()</a></code>. See the documentation of this package <code><a href="https://martinschobben.github.io/point/articles/IC-precision.html" class="external-link">vignette("IC-precision", package = "point")</a></code> for an extensive overview of the complete functionality of these functions as well as the mathematics behind the statistics.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># single ion statistics</span>
<span class="va">stat_X_64_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://martinschobben.github.io/point/reference/stat_X.html" class="external-link">stat_X</a></span><span class="op">(</span><span class="va">tb</span>, <span class="va">file.nm</span>, <span class="va">sample.nm</span>, <span class="va">dim_name.nm</span>, <span class="va">grid.nm</span><span class="op">)</span>
<span class="fu"><a href="../reference/download_point.html">write_point</a></span><span class="op">(</span><span class="va">stat_X_64_all</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stat_X_64_all</span><span class="op">)</span></code></pre></div>
<p>The same can be done for the statistics of isotope analysis with appropriate error propagation with the function <code><a href="https://martinschobben.github.io/point/reference/stat_X.html" class="external-link">stat_R()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># single ion statistics</span>
<span class="va">stat_R_64_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://martinschobben.github.io/point/reference/stat_X.html" class="external-link">stat_R</a></span><span class="op">(</span><span class="va">tb</span>, <span class="st">"13C"</span>, <span class="st">"12C"</span>, <span class="va">file.nm</span>, <span class="va">sample.nm</span>, <span class="va">dim_name.nm</span>, 
                        <span class="va">grid.nm</span><span class="op">)</span>
<span class="fu"><a href="../reference/download_point.html">write_point</a></span><span class="op">(</span><span class="va">stat_R_64_all</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stat_R_64_all</span><span class="op">)</span></code></pre></div>
<p>The reduced <span class="math inline">\(\chi^2\)</span> can then be used to assess the machine performance and analyte homogeneity as it cross-validates the observed error estimate with the theoretical Poisson-based precision. For example, the reduced <span class="math inline">\(\chi^2\)</span> of an isotope ratio equates to:</p>
<p><span class="math display">\[\begin{equation}
  \chi^2 = \left( \frac{s_{\bar{R}}} {\hat{s}_{\bar{R}}} \right)^2   
\end{equation}\]</span></p>
<p>where values close to <span class="math inline">\(1\)</span> suggest good agreement between the actual measurement and the predicted value <span class="citation">(Kilburn and Wacey 2015)</span>. Values lower than <span class="math inline">\(1\)</span> suggest that the analysis was better than predicted, and values higher than <span class="math inline">\(1\)</span> indicate that the analysis was worse than predicted by Poisson statistics.</p>
<p>Intra-analysis isotope variation is measured by the test (based on F-statistic) as outlined in the paper. Varying degrees of variance in the ionization efficiency of the analyte cause a systematic trend that is mirrored in both isotopes. This ionization efficiency trend has been parameterized as the difference between the relative standard deviation of the common isotope <span class="math inline">\(\epsilon_{X^{a}}\)</span> and the theoretical standard deviation <span class="math inline">\(\hat{\epsilon}_{N^{a}}\)</span>, based on Poisson statistics (so-called “excess” ionization, see paper). This ionization efficiency trend has an impact on the accuracy of the intra-analysis isotope test (see paper), and therefore has been included in the simulated data. For this comparative approach an excess ionization of below &lt; 6% has been omitted, because of limited detection at the lower ranges of ionization efficiency. The remainder has been divided into three groups; low (5–15%), medium (15–25%) and high (25–35%) excess ionization with the <code><a href="https://ggplot2.tidyverse.org/reference/cut_interval.html" class="external-link">ggplot2::cut_width()</a></code> function <span class="citation">(Wickham et al. 2021; Wickham 2016)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rlang.r-lib.org" class="external-link">rlang</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>

<span class="co"># groups</span>
<span class="va">grps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">quos</a></span><span class="op">(</span><span class="va">type.nm</span>, <span class="va">trend.nm</span>, <span class="va">force.nm</span>, <span class="va">spot.nm</span><span class="op">)</span>
<span class="co"># R stats synthetic data</span>
<span class="va">tb_R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://martinschobben.github.io/point/reference/stat_X.html" class="external-link">stat_R</a></span><span class="op">(</span><span class="va">simu_sens_IC_intra</span>, <span class="st">"13C"</span>, <span class="st">"12C"</span>, <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">grps</span>, .X <span class="op">=</span> <span class="va">Xt.sm</span>, .N <span class="op">=</span> <span class="va">N.sm</span><span class="op">)</span> 
<span class="co"># single ions stats</span>
<span class="va">tb_X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://martinschobben.github.io/point/reference/stat_X.html" class="external-link">stat_X</a></span><span class="op">(</span><span class="va">simu_sens_IC_intra</span>, <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">grps</span>, .X <span class="op">=</span> <span class="va">Xt.sm</span>, .N <span class="op">=</span> <span class="va">N.sm</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species.nm</span> <span class="op">==</span> <span class="st">"12C"</span><span class="op">)</span>
<span class="co"># filter and cut continuous ionization efficiency</span>
<span class="va">simu_stat_eval_intra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">simu_CooksD_IC_intra</span>, <span class="va">tb_X</span>, <span class="va">tb_R</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html" class="external-link">reduce</a></span><span class="op">(</span><span class="va">left_join</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">grps</span>, <span class="va">as_name</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ion_trend <span class="op">=</span> <span class="va">RS_Xt.sm</span> <span class="op">-</span> <span class="va">hat_RS_N.sm</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ion_trend</span> <span class="op">&gt;</span> <span class="fl">6</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    ion_trend <span class="op">=</span>
      <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/cut_interval.html" class="external-link">cut_width</a></span><span class="op">(</span><span class="va">ion_trend</span>, <span class="fl">10</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>A simple ggplot (<code>ggplot() + geom_point()</code>) <span class="citation">(Wickham et al. 2021; Wickham 2016)</span> has been used to compare the <span class="math inline">\(F\)</span> statistic for intra-analysis isotope variability with the reduced <span class="math inline">\(\chi^2\)</span> for an assessment of the precision.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot F vs Chi2</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">simu_stat_eval_intra</span>, 
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">chi2_R_N.sm</span>, y <span class="op">=</span> <span class="va">F_R_Xt.sm</span>, color <span class="op">=</span> <span class="va">force.nm</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">type.nm</span><span class="op">)</span>, rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">ion_trend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_distiller</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"isotope variation in substrate ("</span><span class="op">*</span> <span class="va">Delta</span><span class="op">[</span><span class="va">B</span> <span class="op">-</span> <span class="va">A</span><span class="op">]</span> <span class="op">*</span><span class="st">" \u2030 )"</span><span class="op">)</span>,
    palette <span class="op">=</span> <span class="st">"YlOrRd"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="cn">F</span><span class="op">[</span><span class="st">"(2),(n-3)"</span><span class="op">]</span><span class="op">)</span>,
    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
    breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">chi</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,
    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
    breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Precision vs. accuracy"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/themes_IC.html">themes_IC</a></span><span class="op">(</span>base <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> 

<span class="co"># save </span>
<span class="fu"><a href="../reference/download_point.html">save_point</a></span><span class="op">(</span><span class="st">"simu_precision"</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/last_plot.html" class="external-link">last_plot</a></span><span class="op">(</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">14</span>, height <span class="op">=</span> <span class="fl">14</span>, unit <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="figures/simu_precision.png" alt="The sensitivity of precision and accuracy-based test statistics to intra-isotope variability." width="80%"><p class="caption">
The sensitivity of precision and accuracy-based test statistics to intra-isotope variability.
</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-Kilburn2015a">
<p>Kilburn, Matt R., and David Wacey. 2015. <em>Nanoscale secondary ion mass spectrometry (NanoSIMS) as an analytical tool in the geosciences</em>. Vols. 2015-Janua. 4. <a href="https://doi.org/10.1039/9781782625025-00001" class="external-link">https://doi.org/10.1039/9781782625025-00001</a>.</p>
</div>
<div id="ref-point">
<p>Schobben, Martin. 2022. <em>Point: Reading, Processing, and Analysing Raw Ion Count Data</em>. <a href="https://martinschobben.github.io/point/" class="external-link">https://martinschobben.github.io/point/</a>.</p>
</div>
<div id="ref-Slodzian2004">
<p>Slodzian, G., F. Hillion, F. J. Stadermann, and E. Zinner. 2004. “QSA influences on isotopic ratio measurements.” <em>Applied Surface Science</em> 231-232: 874–77. <a href="https://doi.org/10.1016/j.apsusc.2004.03.155" class="external-link">https://doi.org/10.1016/j.apsusc.2004.03.155</a>.</p>
</div>
<div id="ref-ggplot22016">
<p>Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org" class="external-link">https://ggplot2.tidyverse.org</a>.</p>
</div>
<div id="ref-ggplot2">
<p>Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, and Dewey Dunnington. 2021. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link">https://CRAN.R-project.org/package=ggplot2</a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Martin Schobben.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
